{
  "fileSystem": {
    "/": {
      "type": "directory",
      "contents": {
        "home": { 
          "type": "directory", 
          "contents": {
            "researcher": {
              "type": "directory",
              "contents": {
                "mission_brief.txt": {
                  "type": "file",
                  "content": "THE WHITE HAT TEST - RESPONSIBLE DISCLOSURE CTF\n============================================\n\nMISSION BRIEFING (Static Fallback)\n=================================\n\nWelcome, Security Researcher!\n\nThis is a fallback version of the mission brief.\nThe dynamic version with current session challenges should load automatically.\n\nIf you're seeing this message, there may be an issue with the dynamic loading.\nPlease refresh the page or contact support.\n\nüéØ OBJECTIVES:\n- Discover 7 security flags hidden throughout the system\n- Use the integrated Challenge Tracker for flag submission\n- Practice ethical security assessment methodologies\n\nüìã FLAG SUBMISSION PROCESS:\n1. Open the Challenge Tracker (top-right corner)\n2. Select a challenge from the dropdown menu\n3. Enter the discovered flag in the input field\n4. Click 'Verify Flag' to submit for validation\n5. Track your progress with visual completion indicators\n\nüîç EXPLORATION TIPS:\n- Check configuration files (.bashrc, .env, config files)\n- Examine log files and system directories\n- Look for comments in source code\n- Review backup scripts and scheduled tasks\n- Analyze network configuration and SSL certificates\n\nFor detailed current session challenges, the system should automatically\nload the dynamic mission brief with your specific randomized flags.\n\nSecurity Team Lead\nTechCorp Security Division",
                  "size": 750
                },
                ".bashrc": {
                  "type": "file",
                  "content": "# ~/.bashrc: executed by bash(1) for non-login shells.\n\nexport PATH=$HOME/bin:/usr/local/bin:$PATH\nexport PS1='researcher@sandbox:$PWD$ '\n\n# WHT{enum_services_first} - Hidden in environment\nalias ll='ls -alF'\nalias la='ls -A'\nalias l='ls -CF'",
                  "size": 312,
                  "hidden": true,
                  "flag_ids": ["WHT-ENV"]
                },
                ".hidden_notes": {
                  "type": "file",
                  "content": "Personal Research Notes\n======================\n\nRemember to check:\n- Open ports and services (ss, netstat)\n- Web directories (/var/www/)\n- Config files in /etc/\n- SUID binaries\n- Log files in /var/log/\n\nThe company mentioned they use nginx on port 8080.",
                  "size": 245,
                  "hidden": true
                }
              },
              "always_visible": true
            },
            "www-data": {
              "type": "directory",
              "contents": {
                ".profile": {
                  "type": "file",
                  "content": "# ~/.profile: executed by the command interpreter for login shells.\n\nexport PATH=\"/usr/local/bin:/usr/bin:/bin\"\nexport USER=\"www-data\"",
                  "size": 156
                }
              }
            },
            "admin": {
              "type": "directory",
              "contents": {
                ".env": {
                  "type": "file",
                  "content": "# Admin Environment Configuration\nDATABASE_URL=postgresql://admin:secret123@localhost:5432/techcorp\nSECRET_KEY=super-secret-key-for-flask-app\nFLAG_4=WHT{environment_variables_leak_secrets}\nADMIN_EMAIL=admin@techcorp.local\nDEBUG=true",
                  "size": 234,
                  "hidden": true,
                  "flag_ids": ["WHT-ENV2"]
                },
                "backup_script.sh": {
                  "type": "file",
                  "content": "#!/bin/bash\n# Daily backup script\n# Run: 0 2 * * * /home/admin/backup_script.sh\n# WHT{backup_script_analysis} - Found in admin automation\n\nBACKUP_DIR=\"/var/backups/daily\"\nDATE=$(date +%Y%m%d)\n\n# Create backup directory\nmkdir -p $BACKUP_DIR\n\n# Backup web files\ntar -czf $BACKUP_DIR/web_$DATE.tar.gz /var/www/html/\n\n# Backup database\npg_dump techcorp > $BACKUP_DIR/db_$DATE.sql\n\necho \"Backup completed: $DATE\"",
                  "size": 387,
                  "permissions": "755",
                  "flag_ids": ["WHT-BACKUP"]
                },
                ".bash_history": {
                  "type": "file",
                  "content": "ls -la\ncat /etc/passwd\nmysql -u root -p\n# Accidentally typed password: admin123\n# WHT{command_history_forensics}\nfind / -name '*.conf'\ngrep -r 'password' /etc/\nsudo systemctl restart nginx\nhistory | grep mysql\nclear",
                  "size": 234,
                  "hidden": true,
                  "flag_ids": ["WHT-HIST"]
                }
              },
              "flag_ids": ["WHT-ENV2", "WHT-BACKUP", "WHT-HIST"]
            },
            "security": {
              "type": "directory",
              "contents": {
                "incident_response_plan.txt": {
                  "type": "file",
                  "content": "TECHCORP INCIDENT RESPONSE PLAN\n==============================\n\nDOCUMENT VERSION: 2.1\nLAST UPDATED: 2025-09-15\nCLASSIFICATION: Internal Use Only\n\nüö® INCIDENT RESPONSE PHASES\n\n1. PREPARATION\n   - Incident Response Team: security@techcorp.com\n   - Emergency Contacts: +1-800-SECURITY\n   - Escalation Matrix: CISO -> CTO -> CEO\n\n2. IDENTIFICATION & DETECTION\n   - Anomaly Indicators:\n     * Login attempts at unusual hours (e.g., 3:00 AM)\n     * Multiple failed authentications from foreign IPs\n     * Unusual data access patterns\n     * Privilege escalation attempts\n\n3. CONTAINMENT (FIRST STEP IN BREACH RESPONSE)\n   ‚ö†Ô∏è  CRITICAL: Contain the breach BEFORE customer notification\n   - Isolate affected systems immediately\n   - Preserve evidence for forensic analysis\n   - Document all containment actions\n\n4. ERADICATION & RECOVERY\n   - Remove malicious artifacts\n   - Patch vulnerabilities\n   - Restore systems from clean backups\n\n5. LESSONS LEARNED\n   - Post-incident review\n   - Update security controls\n   - Staff training improvements\n\n# WHT{incident_response_procedures} - Proper breach response protocol\n\nüìã BREACH RESPONSE CHECKLIST:\n‚òê Notify incident response team (NOT customers first)\n‚òê Contain the breach to prevent further damage\n‚òê Preserve evidence for investigation\n‚òê Assess scope and impact\n‚òê Begin eradication procedures\n‚òê Prepare customer communications (after containment)\n\nüí° SECURITY REMINDERS:\n- Digital hygiene: Regular updates, verified software sources\n- Password security: 12+ characters, avoid reuse\n- 2FA implementation: Mandatory for privileged accounts\n- Social engineering awareness: Verify requests through official channels",
                  "size": 1456,
                  "flag_ids": ["WHT-INCIDENT"]
                },
                "digital_hygiene_guide.txt": {
                  "type": "file",
                  "content": "DIGITAL HYGIENE BEST PRACTICES\n==============================\n\nüîê PASSWORD SECURITY\nStrong passwords are your first line of defense against brute-force attacks.\n\nWEAK EXAMPLES (avoid these):\n- password123 (common words + numbers)\n- ilovepizza (personal preferences)\n- J0hn2024! (predictable substitutions)\n\nSTRONG EXAMPLE:\n- q2W#r7&zLp0 (random, 12+ chars, mixed case, symbols)\n\nüõ°Ô∏è SECURITY PRACTICES\n‚úÖ DO:\n- Regularly update systems and software\n- Download software from verified sources only\n- Use unique passwords for each account\n- Enable two-factor authentication\n- Scan suspicious files before opening\n\n‚ùå DON'T:\n- Reuse passwords for convenience\n- Delay security updates\n- Download from unknown sources\n- Ignore security warnings\n- Share credentials via email/chat\n\nüö® THREAT AWARENESS\n- Social engineering targets human psychology\n- DoS attacks disrupt services (don't steal data)\n- Brute-force attacks try many password combinations\n- Malware can hide in seemingly innocent files\n\nüéØ INCIDENT SIGNS\n- Unusual login times (3 AM activity)\n- Foreign IP access attempts\n- Unexpected system slowdowns\n- Suspicious file modifications\n- Unauthorized privilege changes",
                  "size": 1123
                }
              },
              "flag_ids": ["WHT-INCIDENT"]
            }
          }
        },
        "var": { 
          "type": "directory", 
          "contents": {
            "www": {
              "type": "directory",
              "contents": {
                "html": {
                  "type": "directory",
                  "contents": {
                    "index.html": {
                      "type": "file",
                      "content": "<!DOCTYPE html>\n<html>\n<head>\n    <title>TechCorp Web Application</title>\n</head>\n<body>\n    <h1>Welcome to TechCorp</h1>\n    <p>Secure Web Application v2.1</p>\n    <!-- WHT{source_code_comments} - Check the source! -->\n    <p>Please login to continue.</p>\n</body>\n</html>",
                      "size": 287,
                      "flag_ids": ["WHT-SRC"]
                    },
                    "admin": {
                      "type": "directory",
                      "contents": {
                        "config.php": {
                          "type": "file",
                          "content": "<?php\n// Admin panel configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'admin');\ndefine('DB_PASS', 'weakpassword123');\ndefine('DB_NAME', 'techcorp');\n\n// Security note: This should be in environment variables!\n// WHT{database_credentials_found}\n\n$admin_key = 'admin_secret_2024';\n?>",
                          "size": 298,
                          "flag_ids": ["WHT-DB"]
                        },
                        "login.php": {
                          "type": "file",
                          "content": "<?php\nrequire_once 'config.php';\n\nif ($_POST['username'] && $_POST['password']) {\n    // Vulnerable to SQL injection - needs fixing\n    $query = \"SELECT * FROM users WHERE username='\" . $_POST['username'] . \"' AND password='\" . $_POST['password'] . \"'\";\n    // This is a security issue - parameterized queries needed\n}\n?>",
                          "size": 289
                        }
                      },
                      "flag_ids": ["WHT-DB"]
                    },
                    "uploads": {
                      "type": "directory",
                      "contents": {
                        "readme.txt": {
                          "type": "file",
                          "content": "Upload Directory\n================\n\nThis directory is used for user file uploads.\nMake sure to validate all uploaded files!\n\nSecurity reminder: Check file extensions and content types.",
                          "size": 156
                        }
                      }
                    }
                  },
                  "flag_ids": ["WHT-SRC", "WHT-DB"]
                }
              }
            },
            "log": {
              "type": "directory",
              "contents": {
                "nginx": {
                  "type": "directory",
                  "contents": {
                    "access.log": {
                      "type": "file",
                      "content": "192.168.1.100 - - [27/Sep/2025:08:00:00 +0000] \"GET / HTTP/1.1\" 200 287\n192.168.1.101 - - [27/Sep/2025:08:15:23 +0000] \"GET /admin HTTP/1.1\" 200 156\n192.168.1.102 - - [27/Sep/2025:08:30:45 +0000] \"POST /admin/login.php HTTP/1.1\" 302 0\n# WHT{log_files_reveal_activity} - Check the access patterns\n192.168.1.103 - - [27/Sep/2025:09:00:12 +0000] \"GET /admin/config.php HTTP/1.1\" 403 0\n",
                      "size": 445,
                      "flag_ids": ["WHT-LOG"]
                    },
                    "error.log": {
                      "type": "file",
                      "content": "2025/09/27 08:30:45 [error] 1234#0: *1 access forbidden by rule, client: 192.168.1.103, server: _, request: \"GET /admin/config.php HTTP/1.1\"\n2025/09/27 09:00:12 [warn] 1234#0: *2 security headers missing in response\n2025/09/27 09:15:30 [error] 1234#0: *3 SQL injection attempt detected in request\n",
                      "size": 367
                    }
                  },
                  "flag_ids": ["WHT-LOG"]
                },
                "auth.log": {
                  "type": "file",
                  "content": "Sep 27 08:00:01 sandbox login[1234]: LOGIN researcher on tty1\nSep 27 08:15:23 sandbox sudo[1456]: researcher : TTY=pts/0 ; PWD=/home/researcher ; USER=root ; COMMAND=/bin/ls /var/log\nSep 27 08:30:45 sandbox login[1789]: FAILED LOGIN ATTEMPT for admin from 192.168.1.50\nSep 27 09:00:12 sandbox sudo[2001]: researcher : PASSWORD authentication failure\n",
                  "size": 389
                },
                "syslog": {
                  "type": "file",
                  "content": "Sep 27 08:00:00 sandbox systemd[1]: Started Daily apt download activities.\nSep 27 08:15:00 sandbox CRON[1234]: (root) CMD (/usr/local/bin/backup_script.sh)\nSep 27 08:30:00 sandbox nginx[5678]: Configuration reload successful\nSep 27 09:00:00 sandbox systemd[1]: Started Cleanup of Temporary Directories.\n",
                  "size": 312
                },
                "social_engineering.log": {
                  "type": "file",
                  "content": "2025-09-27 09:00:12 [EMAIL] From: it-support@techcorp-urgent.com\n2025-09-27 09:00:15 [EMAIL] Subject: URGENT: Account Suspension Notice - Immediate Action Required\n2025-09-27 09:00:18 [EMAIL] Body: Your account will be suspended in 2 hours due to suspicious activity.\n2025-09-27 09:00:20 [EMAIL] Body: Click here immediately to verify: http://fake-techcorp-login.malicious.com\n2025-09-27 09:01:00 [PHONE] Caller claimed to be CEO, demanded immediate password reset\n2025-09-27 09:02:30 [EMAIL] Phishing attempt: 'We are from IT department, send us your credentials for maintenance'\n# WHT{social_engineering_awareness} - Manipulation tactics identified\n2025-09-27 09:05:00 [ANALYSIS] Red flags: Urgency, authority claims, external links, fear tactics\n2025-09-27 09:06:00 [POLICY] Social engineering exploits human psychology, not technical vulnerabilities",
                  "size": 789,
                  "flag_ids": ["WHT-SOCIAL"]
                },
                "ddos_attack.log": {
                  "type": "file",
                  "content": "2025-09-27 10:00:01 [ALERT] DDoS attack detected from multiple sources\n2025-09-27 10:00:05 [ATTACK] SYN_FLOOD: 192.168.100.1 -> 10.0.1.100:80 (50,000 requests/sec)\n2025-09-27 10:00:08 [ATTACK] UDP_FLOOD: 203.0.113.5 -> 10.0.1.100:53 (25,000 packets/sec)\n2025-09-27 10:00:12 [IMPACT] Service response time: 15000ms (normal: 200ms)\n2025-09-27 10:00:15 [IMPACT] Connection timeouts: 95% of requests failing\n2025-09-27 10:01:00 [MITIGATION] Rate limiting activated on edge routers\n2025-09-27 10:01:30 [ANALYSIS] Attack goal: Service unavailability, NOT data theft\n# WHT{denial_of_service_analysis} - DoS attack pattern identified\n2025-09-27 10:02:00 [RECOVERY] Service availability restored after traffic filtering\n2025-09-27 10:05:00 [LESSON] DoS attacks overwhelm resources to disrupt service availability",
                  "size": 887,
                  "flag_ids": ["WHT-DOS"]
                }
              }
            }
          }
        },
        "etc": { 
          "type": "directory", 
          "contents": {
            "nginx": {
              "type": "directory",
              "contents": {
                "nginx.conf": {
                  "type": "file",
                  "content": "user www-data;\nworker_processes auto;\npid /run/nginx.pid;\n\nevents {\n    worker_connections 768;\n}\n\nhttp {\n    # Basic configuration\n    sendfile on;\n    tcp_nopush on;\n    \n    # Security headers missing - needs improvement\n    # add_header X-Frame-Options DENY;\n    # add_header X-Content-Type-Options nosniff;\n    \n    # WHT{nginx_config_review} - Found in server config\n    \n    include /etc/nginx/sites-enabled/*;\n}",
                  "size": 398,
                  "flag_ids": ["WHT-CFG"]
                },
                "sites-available": {
                  "type": "directory",
                  "contents": {
                    "default": {
                      "type": "file",
                      "content": "server {\n    listen 80 default_server;\n    listen [::]:80 default_server;\n    \n    root /var/www/html;\n    index index.html index.htm;\n    \n    server_name _;\n    \n    location / {\n        try_files $uri $uri/ =404;\n    }\n    \n    # Weak security configuration\n    location /admin {\n        # Missing authentication!\n        try_files $uri $uri/ =404;\n    }\n}",
                      "size": 312
                    }
                  }
                }
              },
              "flag_ids": ["WHT-CFG"]
            },
            "ssl": {
              "type": "directory",
              "contents": {
                "private": {
                  "type": "directory",
                  "contents": {
                    "server.key": {
                      "type": "file",
                      "content": "-----BEGIN PRIVATE KEY-----\n# WHT{ssl_certificate_analysis}\n# This is a sample SSL private key file\n# In production, never expose private keys!\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC7VJTUt9Us8cKB\nwwdwuTn3sNrPYc4Pq6f+jY1vV6PpNK7VmrYz9yU7NkKr+OjXNbqKrO1Og5WqL5O\n-----END PRIVATE KEY-----\n",
                      "size": 345,
                      "permissions": "600",
                      "flag_ids": ["WHT-SSL"]
                    }
                  },
                  "flag_ids": ["WHT-SSL"]
                },
                "certs": {
                  "type": "directory",
                  "contents": {}
                }
              }
            },
            "passwd": {
              "type": "file",
              "content": "root:x:0:0:root:/root:/bin/bash\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nresearcher:x:1000:1000:Security Researcher:/home/researcher:/bin/bash\nadmin:x:1001:1001:System Admin:/home/admin:/bin/bash",
              "size": 213
            },
            "security": {
              "type": "directory",
              "contents": {
                "auth_config.conf": {
                  "type": "file",
                  "content": "# Authentication Configuration\n# TechCorp Security Settings\n\n[AUTHENTICATION]\npassword_policy=strong\nmin_length=12\nrequire_symbols=true\nmax_attempts=3\nlockout_duration=300\n\n[TWO_FACTOR_AUTH]\n# CRITICAL SECURITY FLAW: 2FA bypass enabled for 'convenience'\nenabled=true\nbypass_for_internal=true\nbackup_codes_allowed=unlimited\n# WHT{two_factor_authentication_bypass} - 2FA implementation flaw\nemergency_bypass=admin_override\n\n[PASSWORD_EXAMPLES]\n# Weak passwords (vulnerable to brute-force)\nweak_example1=password123\nweak_example2=ilovepizza\nweak_example3=J0hn2024!\n\n# Strong password (resistant to brute-force)\nstrong_example=q2W#r7&zLp0\n\n[SECURITY_NOTES]\n# Strong passwords should be 12+ characters with mixed case, numbers, symbols\n# Social engineering attacks manipulate people, not systems\n# 2FA should be mandatory for all privileged accounts",
                  "size": 945,
                  "flag_ids": ["WHT-2FA"]
                }
              },
              "flag_ids": ["WHT-2FA"]
            },
            "hosts": {
              "type": "file",
              "content": "127.0.0.1\tlocalhost\n127.0.1.1\tsandbox\n192.168.1.100\ttechcorp-db\n192.168.1.101\ttechcorp-api\n# WHT{network_configuration_analysis} - Internal network mapping\n10.0.0.5\tinternal-vpn\n172.16.1.10\tadmin-workstation",
              "size": 189,
              "flag_ids": ["WHT-NET"]
            },
            "resolv.conf": {
              "type": "file",
              "content": "# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)\n# DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nsearch techcorp.local internal.corp",
              "size": 234
            },
            "crontab": {
              "type": "file",
              "content": "# /etc/crontab: system-wide crontab\n# WHT{scheduled_task_discovery}\nSHELL=/bin/sh\nPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\n\n# m h dom mon dow user\tcommand\n17 *\t* * *\troot    cd / && run-parts --report /etc/cron.hourly\n25 6\t* * *\troot\ttest -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )\n47 6\t* * 7\troot\ttest -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )\n52 6\t1 * *\troot\ttest -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )\n0 2\t* * *\tadmin\t/home/admin/backup_script.sh",
              "size": 567,
              "flag_ids": ["WHT-CRON"]
            }
          },
          "flag_ids": ["WHT-NET", "WHT-CRON", "WHT-CFG", "WHT-SSL"]
        },
        "usr": { 
          "type": "directory", 
          "contents": {
            "local": {
              "type": "directory",
              "contents": {
                "bin": {
                  "type": "directory",
                  "contents": {
                    "backup_script.sh": {
                      "type": "file",
                      "content": "#!/bin/bash\n# System backup utility\n# WHT{suid_binary_analysis} - Check file permissions\n\n# This script has SUID bit set - potential security issue\nif [ \"$EUID\" -eq 0 ]; then\n    echo \"Running with root privileges\"\n    # Backup operations here\n    tar -czf /tmp/system_backup.tar.gz /etc/ /var/log/\nelse\n    echo \"Backup requires root privileges\"\nfi",
                      "size": 378,
                      "permissions": "4755",
                      "flag_ids": ["WHT-SUID"]
                    },
                    "security_scan.sh": {
                      "type": "file",
                      "content": "#!/bin/bash\n# Security scanning utility\n\necho \"TechCorp Security Scanner v1.0\"\necho \"==============================\"\n\n# Basic system checks\necho \"Checking for SUID binaries...\"\nfind /usr -perm -4000 -type f 2>/dev/null\n\necho \"Checking for world-writable files...\"\nfind /var -perm -002 -type f 2>/dev/null\n\necho \"Scan complete.\"",
                      "size": 334,
                      "permissions": "755"
                    }
                  },
                  "flag_ids": ["WHT-SUID"]
                }
              }
            }
          }
        },
        "tmp": { 
          "type": "directory", 
          "contents": {
            "ctf_completion.txt": {
              "type": "file",
              "content": "Congratulations!\n===============\n\nYou have successfully completed The White Hat Test!\n\nWHT{responsible_disclosure_complete}\n\nRemember:\n- Always follow responsible disclosure practices\n- Document findings thoroughly\n- Provide clear remediation steps\n- Respect system boundaries and permissions\n\nThank you for participating in ethical security research!",
              "size": 356,
              "flag_ids": ["WHT-COMPL"]
            },
            "debug.log": {
              "type": "file",
              "content": "2025-09-27 08:00:01 - Application started\n2025-09-27 08:15:23 - Database connection established\n2025-09-27 08:30:45 - User login attempt: admin\n2025-09-27 09:00:12 - WHT{temporary_files_investigation}\n2025-09-27 09:15:30 - Backup process initiated\n2025-09-27 09:30:00 - Security scan completed",
              "size": 287,
              "flag_ids": ["WHT-TEMP"]
            }
          },
          "flag_ids": ["WHT-COMPL", "WHT-TEMP"]
        },
        "proc": { 
          "type": "directory", 
          "contents": {
            "1": {
              "type": "directory",
              "contents": {
                "environ": {
                  "type": "file",
                  "content": "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nHOME=/root\nLOGNAME=root\nUSER=root\nSHELL=/bin/bash\n# WHT{process_memory_analysis}\nSECRET_TOKEN=proc_env_secret_12345",
                  "size": 187,
                  "flag_ids": ["WHT-PROC"]
                }
              },
              "flag_ids": ["WHT-PROC"]
            }
          }
        }
      }
    }
  }
}